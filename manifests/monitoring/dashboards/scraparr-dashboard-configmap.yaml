# Grafana Dashboard - Scraparr ARR Metrics
# Monitors all *ARR apps via Scraparr Prometheus exporter
# Based on Grafana dashboard #22934, customized for homelab
# Auto-provisioned via grafana_dashboard label
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: scraparr-dashboard
  namespace: monitoring
  annotations:
    grafana_folder: "Homelab"
  labels:
    grafana_dashboard: "1"
    app.kubernetes.io/name: grafana
    app.kubernetes.io/part-of: kube-prometheus-stack
data:
  scraparr.json: |
    {
      "annotations": {
        "list": []
      },
      "editable": true,
      "fiscalYearStartMonth": 0,
      "graphTooltip": 1,
      "links": [],
      "panels": [
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 0
          },
          "id": 1,
          "title": "Service Health",
          "description": "UP/DOWN status for each *ARR app monitored by Scraparr",
          "type": "row"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "DOWN",
              "mappings": [
                {
                  "options": {
                    "0": {
                      "color": "red",
                      "text": "DOWN"
                    },
                    "1": {
                      "color": "green",
                      "text": "UP"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "red",
                    "value": null
                  },
                  {
                    "color": "green",
                    "value": 1
                  }
                ]
              }
            }
          },
          "gridPos": {
            "h": 4,
            "w": 6,
            "x": 0,
            "y": 1
          },
          "id": 2,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "auto"
          },
          "title": "Sonarr",
          "description": "Sonarr service health via Scraparr. UP = API responding. DOWN = unreachable or crashed.",
          "type": "stat",
          "targets": [
            {
              "expr": "scraparr_services_up{scraparr_services=\"sonarr\"}",
              "legendFormat": "Sonarr"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "DOWN",
              "mappings": [
                {
                  "options": {
                    "0": {
                      "color": "red",
                      "text": "DOWN"
                    },
                    "1": {
                      "color": "green",
                      "text": "UP"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "red",
                    "value": null
                  },
                  {
                    "color": "green",
                    "value": 1
                  }
                ]
              }
            }
          },
          "gridPos": {
            "h": 4,
            "w": 6,
            "x": 6,
            "y": 1
          },
          "id": 3,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "auto"
          },
          "title": "Radarr",
          "description": "Radarr service health via Scraparr. UP = API responding. DOWN = unreachable or crashed.",
          "type": "stat",
          "targets": [
            {
              "expr": "scraparr_services_up{scraparr_services=\"radarr\"}",
              "legendFormat": "Radarr"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "DOWN",
              "mappings": [
                {
                  "options": {
                    "0": {
                      "color": "red",
                      "text": "DOWN"
                    },
                    "1": {
                      "color": "green",
                      "text": "UP"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "red",
                    "value": null
                  },
                  {
                    "color": "green",
                    "value": 1
                  }
                ]
              }
            }
          },
          "gridPos": {
            "h": 4,
            "w": 6,
            "x": 12,
            "y": 1
          },
          "id": 4,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "auto"
          },
          "title": "Prowlarr",
          "description": "Prowlarr service health via Scraparr. UP = API responding. DOWN = unreachable or crashed.",
          "type": "stat",
          "targets": [
            {
              "expr": "scraparr_services_up{scraparr_services=\"prowlarr\"}",
              "legendFormat": "Prowlarr"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "DOWN",
              "mappings": [
                {
                  "options": {
                    "0": {
                      "color": "red",
                      "text": "DOWN"
                    },
                    "1": {
                      "color": "green",
                      "text": "UP"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "red",
                    "value": null
                  },
                  {
                    "color": "green",
                    "value": 1
                  }
                ]
              }
            }
          },
          "gridPos": {
            "h": 4,
            "w": 6,
            "x": 18,
            "y": 1
          },
          "id": 5,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "auto"
          },
          "title": "Bazarr",
          "description": "Bazarr service health via Scraparr. UP = API responding. DOWN = unreachable or crashed.",
          "type": "stat",
          "targets": [
            {
              "expr": "scraparr_services_up{scraparr_services=\"bazarr\"}",
              "legendFormat": "Bazarr"
            }
          ]
        },
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 5
          },
          "id": 10,
          "title": "Library Stats",
          "description": "Library sizes and missing content across Radarr, Sonarr, and Bazarr",
          "type": "row"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "0",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "blue",
                    "value": null
                  }
                ]
              }
            }
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 0,
            "y": 6
          },
          "id": 11,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "auto"
          },
          "title": "Total Movies",
          "description": "Total movies tracked in Radarr (monitored + unmonitored). Grows as you add movies to your watchlist.",
          "type": "stat",
          "targets": [
            {
              "expr": "radarr_movies_total",
              "legendFormat": "Movies"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "0",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "orange",
                    "value": null
                  }
                ]
              }
            }
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 4,
            "y": 6
          },
          "id": 12,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "auto"
          },
          "title": "Missing Movies",
          "description": "Movies monitored but not yet downloaded. High count is normal for new libraries — Radarr searches indexers automatically.",
          "type": "stat",
          "targets": [
            {
              "expr": "radarr_missing_movies_total",
              "legendFormat": "Missing"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "0",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "blue",
                    "value": null
                  }
                ]
              }
            }
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 8,
            "y": 6
          },
          "id": 13,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "auto"
          },
          "title": "Total Series",
          "description": "Total TV series tracked in Sonarr (monitored + unmonitored). Grows as you add shows to your watchlist.",
          "type": "stat",
          "targets": [
            {
              "expr": "sonarr_series_total",
              "legendFormat": "Series"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "0",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "orange",
                    "value": null
                  }
                ]
              }
            }
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 12,
            "y": 6
          },
          "id": 14,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "auto"
          },
          "title": "Missing Episodes",
          "description": "Episodes monitored but not yet downloaded. High count is normal — includes all missing episodes across all tracked series.",
          "type": "stat",
          "targets": [
            {
              "expr": "sonarr_missing_episodes_total",
              "legendFormat": "Missing"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "0",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "blue",
                    "value": null
                  }
                ]
              }
            }
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 16,
            "y": 6
          },
          "id": 15,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "auto"
          },
          "title": "Prowlarr Indexers",
          "description": "Number of indexers configured in Prowlarr. Metric splits by type (torrent/usenet) — summed here. Currently 5 public torrent indexers: 1337x, TheRARBG, EZTV, YTS, Nyaa.si.",
          "type": "stat",
          "targets": [
            {
              "expr": "sum(prowlarr_indexer_count)",
              "legendFormat": "Indexers"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "0",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "orange",
                    "value": null
                  }
                ]
              }
            }
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 20,
            "y": 6
          },
          "id": 16,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "auto"
          },
          "title": "Wanted Subtitles",
          "description": "Movies + episodes missing subtitles (Bazarr). Bazarr automatically searches for subtitles on configured providers.",
          "type": "stat",
          "targets": [
            {
              "expr": "bazarr_wanted_movies_total + bazarr_wanted_episodes_total",
              "legendFormat": "Wanted"
            }
          ]
        },
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 10
          },
          "id": 20,
          "title": "Disk Usage",
          "description": "Disk space used and available for media storage",
          "type": "row"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "unit": "decbytes",
              "noValue": "N/A",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "blue",
                    "value": null
                  }
                ]
              }
            }
          },
          "gridPos": {
            "h": 4,
            "w": 8,
            "x": 0,
            "y": 11
          },
          "id": 21,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "auto"
          },
          "title": "Radarr Library Size",
          "description": "Disk space used by Radarr's movie root folder on NFS (/export/Kubernetes/Media/media/movies).",
          "type": "stat",
          "targets": [
            {
              "expr": "radarr_disk_size",
              "legendFormat": "Movies"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "unit": "decbytes",
              "noValue": "N/A",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "blue",
                    "value": null
                  }
                ]
              }
            }
          },
          "gridPos": {
            "h": 4,
            "w": 8,
            "x": 8,
            "y": 11
          },
          "id": 23,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "auto"
          },
          "title": "Sonarr Library Size",
          "description": "Disk space used by Sonarr's series root folder on NFS (/export/Kubernetes/Media/media/tv).",
          "type": "stat",
          "targets": [
            {
              "expr": "sonarr_disk_size",
              "legendFormat": "Series"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "unit": "decbytes",
              "noValue": "N/A",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "blue",
                    "value": null
                  }
                ]
              }
            }
          },
          "gridPos": {
            "h": 4,
            "w": 8,
            "x": 16,
            "y": 11
          },
          "id": 24,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "auto"
          },
          "title": "Media Storage Free",
          "description": "Free space on the NFS media volume (/export/Kubernetes/Media). Shared by Radarr and Sonarr — same filesystem, same free space.",
          "type": "stat",
          "targets": [
            {
              "expr": "radarr_free_disk_size",
              "legendFormat": "Free"
            }
          ]
        },
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 15
          },
          "id": 30,
          "title": "Resource Usage",
          "description": "CPU and memory for the Scraparr exporter pod",
          "type": "row"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "unit": "short",
              "custom": {
                "drawStyle": "line",
                "fillOpacity": 15,
                "lineWidth": 2
              }
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byName",
                  "options": "Request"
                },
                "properties": [
                  {
                    "id": "custom.lineStyle",
                    "value": {
                      "fill": "dash",
                      "dash": [
                        10,
                        10
                      ]
                    }
                  },
                  {
                    "id": "custom.fillOpacity",
                    "value": 0
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Limit"
                },
                "properties": [
                  {
                    "id": "custom.lineStyle",
                    "value": {
                      "fill": "dash",
                      "dash": [
                        10,
                        10
                      ]
                    }
                  },
                  {
                    "id": "custom.fillOpacity",
                    "value": 0
                  },
                  {
                    "id": "color",
                    "value": {
                      "fixedColor": "red",
                      "mode": "fixed"
                    }
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 16
          },
          "id": 31,
          "title": "Scraparr CPU Usage",
          "description": "CPU usage with request/limit reference lines",
          "type": "timeseries",
          "targets": [
            {
              "expr": "rate(container_cpu_usage_seconds_total{namespace=\"arr-stack\", container=\"scraparr\"}[5m])",
              "legendFormat": "Usage"
            },
            {
              "expr": "kube_pod_container_resource_requests{namespace=\"arr-stack\", container=\"scraparr\", resource=\"cpu\"}",
              "legendFormat": "Request"
            },
            {
              "expr": "kube_pod_container_resource_limits{namespace=\"arr-stack\", container=\"scraparr\", resource=\"cpu\"}",
              "legendFormat": "Limit"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "unit": "bytes",
              "custom": {
                "drawStyle": "line",
                "fillOpacity": 15,
                "lineWidth": 2
              }
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byName",
                  "options": "Request"
                },
                "properties": [
                  {
                    "id": "custom.lineStyle",
                    "value": {
                      "fill": "dash",
                      "dash": [
                        10,
                        10
                      ]
                    }
                  },
                  {
                    "id": "custom.fillOpacity",
                    "value": 0
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Limit"
                },
                "properties": [
                  {
                    "id": "custom.lineStyle",
                    "value": {
                      "fill": "dash",
                      "dash": [
                        10,
                        10
                      ]
                    }
                  },
                  {
                    "id": "custom.fillOpacity",
                    "value": 0
                  },
                  {
                    "id": "color",
                    "value": {
                      "fixedColor": "red",
                      "mode": "fixed"
                    }
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 16
          },
          "id": 32,
          "title": "Scraparr Memory Usage",
          "description": "Memory working set with request/limit reference lines",
          "type": "timeseries",
          "targets": [
            {
              "expr": "container_memory_working_set_bytes{namespace=\"arr-stack\", container=\"scraparr\"}",
              "legendFormat": "Usage"
            },
            {
              "expr": "kube_pod_container_resource_requests{namespace=\"arr-stack\", container=\"scraparr\", resource=\"memory\"}",
              "legendFormat": "Request"
            },
            {
              "expr": "kube_pod_container_resource_limits{namespace=\"arr-stack\", container=\"scraparr\", resource=\"memory\"}",
              "legendFormat": "Limit"
            }
          ]
        }
      ],
      "schemaVersion": 39,
      "tags": [
        "arr-stack",
        "scraparr",
        "media"
      ],
      "templating": {
        "list": []
      },
      "refresh": "30s",
      "time": {
        "from": "now-24h",
        "to": "now"
      },
      "timepicker": {},
      "timezone": "Asia/Manila",
      "title": "Scraparr - ARR Metrics",
      "uid": "scraparr-arr-metrics"
    }
