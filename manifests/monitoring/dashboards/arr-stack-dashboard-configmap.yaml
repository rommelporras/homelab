# Grafana Dashboard - ARR Media Stack Overview
# Core: Prowlarr, Sonarr, Radarr, qBittorrent, Jellyfin, Bazarr
# Companions: Seerr, Tdarr, Unpackerr, Scraparr, Recommendarr, Configarr
# Auto-provisioned via grafana_dashboard label
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: arr-stack-dashboard
  namespace: monitoring
  annotations:
    grafana_folder: "Homelab"
  labels:
    grafana_dashboard: "1"
    app.kubernetes.io/name: grafana
    app.kubernetes.io/part-of: kube-prometheus-stack
data:
  arr-stack.json: |
    {
      "annotations": {
        "list": []
      },
      "editable": true,
      "fiscalYearStartMonth": 0,
      "graphTooltip": 1,
      "links": [],
      "panels": [
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 0
          },
          "id": 1,
          "title": "Pod Status \u2014 Core Stack",
          "type": "row",
          "description": "Health and node placement for core ARR services. Shows UP/DOWN status with the node name below. All run as single-replica Deployments with Recreate strategy (RWO PVCs)."
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "DOWN",
              "mappings": [
                {
                  "options": {
                    "1": {
                      "color": "green",
                      "text": "UP"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "red",
                    "value": null
                  },
                  {
                    "color": "green",
                    "value": 1
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 0,
            "y": 1
          },
          "id": 2,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "value_and_name"
          },
          "description": "Prowlarr indexer manager. Provides search results to Sonarr and Radarr.",
          "title": "Prowlarr",
          "type": "stat",
          "targets": [
            {
              "expr": "label_replace(kube_pod_info{namespace=\"arr-stack\", pod=~\"prowlarr.*\"}, \"short_node\", \"cp$1\", \"node\", \"k8s-cp(.*)\")",
              "legendFormat": "{{ short_node }}"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "DOWN",
              "mappings": [
                {
                  "options": {
                    "1": {
                      "color": "green",
                      "text": "UP"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "red",
                    "value": null
                  },
                  {
                    "color": "green",
                    "value": 1
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 4,
            "y": 1
          },
          "id": 3,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "value_and_name"
          },
          "description": "Sonarr TV show manager. Monitors RSS feeds and sends downloads to qBittorrent.",
          "title": "Sonarr",
          "type": "stat",
          "targets": [
            {
              "expr": "label_replace(kube_pod_info{namespace=\"arr-stack\", pod=~\"sonarr.*\"}, \"short_node\", \"cp$1\", \"node\", \"k8s-cp(.*)\")",
              "legendFormat": "{{ short_node }}"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "DOWN",
              "mappings": [
                {
                  "options": {
                    "1": {
                      "color": "green",
                      "text": "UP"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "red",
                    "value": null
                  },
                  {
                    "color": "green",
                    "value": 1
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 8,
            "y": 1
          },
          "id": 4,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "value_and_name"
          },
          "description": "Radarr movie manager. Monitors RSS feeds and sends downloads to qBittorrent.",
          "title": "Radarr",
          "type": "stat",
          "targets": [
            {
              "expr": "label_replace(kube_pod_info{namespace=\"arr-stack\", pod=~\"radarr.*\"}, \"short_node\", \"cp$1\", \"node\", \"k8s-cp(.*)\")",
              "legendFormat": "{{ short_node }}"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "DOWN",
              "mappings": [
                {
                  "options": {
                    "1": {
                      "color": "green",
                      "text": "UP"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "red",
                    "value": null
                  },
                  {
                    "color": "green",
                    "value": 1
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 12,
            "y": 1
          },
          "id": 5,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "value_and_name"
          },
          "description": "qBittorrent download client. Handles all torrent downloads for Sonarr/Radarr.",
          "title": "qBittorrent",
          "type": "stat",
          "targets": [
            {
              "expr": "label_replace(kube_pod_info{namespace=\"arr-stack\", pod=~\"qbittorrent.*\"}, \"short_node\", \"cp$1\", \"node\", \"k8s-cp(.*)\")",
              "legendFormat": "{{ short_node }}"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "DOWN",
              "mappings": [
                {
                  "options": {
                    "1": {
                      "color": "green",
                      "text": "UP"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "red",
                    "value": null
                  },
                  {
                    "color": "green",
                    "value": 1
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 16,
            "y": 1
          },
          "id": 6,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "value_and_name"
          },
          "description": "Jellyfin media server with Intel QSV hardware transcoding. See dedicated Jellyfin dashboard for GPU details.",
          "title": "Jellyfin",
          "type": "stat",
          "targets": [
            {
              "expr": "label_replace(kube_pod_info{namespace=\"arr-stack\", pod=~\"jellyfin.*\"}, \"short_node\", \"cp$1\", \"node\", \"k8s-cp(.*)\")",
              "legendFormat": "{{ short_node }}"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "DOWN",
              "mappings": [
                {
                  "options": {
                    "1": {
                      "color": "green",
                      "text": "UP"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "red",
                    "value": null
                  },
                  {
                    "color": "green",
                    "value": 1
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 20,
            "y": 1
          },
          "id": 7,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "value_and_name"
          },
          "description": "Bazarr subtitle manager. Automatically downloads subtitles for media managed by Sonarr and Radarr.",
          "title": "Bazarr",
          "type": "stat",
          "targets": [
            {
              "expr": "label_replace(kube_pod_info{namespace=\"arr-stack\", pod=~\"bazarr.*\"}, \"short_node\", \"cp$1\", \"node\", \"k8s-cp(.*)\")",
              "legendFormat": "{{ short_node }}"
            }
          ]
        },
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 5
          },
          "id": 40,
          "title": "Pod Status \u2014 Companions",
          "type": "row",
          "description": "Health status for companion apps (Phase 4.26). Seerr/Tdarr/Recommendarr are long-running Deployments. Unpackerr/Scraparr are stateless daemons. Configarr is a daily CronJob \u2014 shows OK if last run succeeded within 25h."
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "DOWN",
              "mappings": [
                {
                  "options": {
                    "1": {
                      "color": "green",
                      "text": "UP"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "red",
                    "value": null
                  },
                  {
                    "color": "green",
                    "value": 1
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 0,
            "y": 6
          },
          "id": 41,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "value_and_name"
          },
          "description": "Seerr media request and discovery app. Jellyfin auth, routes requests to Sonarr/Radarr.",
          "title": "Seerr",
          "type": "stat",
          "targets": [
            {
              "expr": "label_replace(kube_pod_info{namespace=\"arr-stack\", pod=~\"seerr.*\"}, \"short_node\", \"cp$1\", \"node\", \"k8s-cp(.*)\")",
              "legendFormat": "{{ short_node }}"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "DOWN",
              "mappings": [
                {
                  "options": {
                    "1": {
                      "color": "green",
                      "text": "UP"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "red",
                    "value": null
                  },
                  {
                    "color": "green",
                    "value": 1
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 4,
            "y": 6
          },
          "id": 42,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "value_and_name"
          },
          "description": "Tdarr library transcoding server with Intel QSV. Internal node mode \u2014 single pod handles both server and worker.",
          "title": "Tdarr",
          "type": "stat",
          "targets": [
            {
              "expr": "label_replace(kube_pod_info{namespace=\"arr-stack\", pod=~\"tdarr.*\"}, \"short_node\", \"cp$1\", \"node\", \"k8s-cp(.*)\")",
              "legendFormat": "{{ short_node }}"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "DOWN",
              "mappings": [
                {
                  "options": {
                    "1": {
                      "color": "green",
                      "text": "UP"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "red",
                    "value": null
                  },
                  {
                    "color": "green",
                    "value": 1
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 8,
            "y": 6
          },
          "id": 43,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "value_and_name"
          },
          "description": "Unpackerr archive extraction daemon. Extracts RAR-packed torrent downloads for Sonarr/Radarr import.",
          "title": "Unpackerr",
          "type": "stat",
          "targets": [
            {
              "expr": "label_replace(kube_pod_info{namespace=\"arr-stack\", pod=~\"unpackerr.*\"}, \"short_node\", \"cp$1\", \"node\", \"k8s-cp(.*)\")",
              "legendFormat": "{{ short_node }}"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "DOWN",
              "mappings": [
                {
                  "options": {
                    "1": {
                      "color": "green",
                      "text": "UP"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "red",
                    "value": null
                  },
                  {
                    "color": "green",
                    "value": 1
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 12,
            "y": 6
          },
          "id": 44,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "value_and_name"
          },
          "description": "Scraparr Prometheus exporter. Exposes metrics for Sonarr, Radarr, Prowlarr, Bazarr. See dedicated Scraparr dashboard for ARR metrics.",
          "title": "Scraparr",
          "type": "stat",
          "targets": [
            {
              "expr": "label_replace(kube_pod_info{namespace=\"arr-stack\", pod=~\"scraparr.*\"}, \"short_node\", \"cp$1\", \"node\", \"k8s-cp(.*)\")",
              "legendFormat": "{{ short_node }}"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "DOWN",
              "mappings": [
                {
                  "options": {
                    "1": {
                      "color": "green",
                      "text": "UP"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "red",
                    "value": null
                  },
                  {
                    "color": "green",
                    "value": 1
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 16,
            "y": 6
          },
          "id": 45,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "value_and_name"
          },
          "description": "Recommendarr AI-powered media recommendations via Ollama. Connects to Jellyfin watch history + Sonarr/Radarr library.",
          "title": "Recommendarr",
          "type": "stat",
          "targets": [
            {
              "expr": "label_replace(kube_pod_info{namespace=\"arr-stack\", pod=~\"recommendarr.*\"}, \"short_node\", \"cp$1\", \"node\", \"k8s-cp(.*)\")",
              "legendFormat": "{{ short_node }}"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "DOWN",
              "mappings": [
                {
                  "options": {
                    "1": {
                      "color": "green",
                      "text": "UP"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "red",
                    "value": null
                  },
                  {
                    "color": "green",
                    "value": 1
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 20,
            "y": 6
          },
          "id": 47,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "value_and_name"
          },
          "description": "Byparr FlareSolverr-compatible proxy for bypassing Cloudflare challenges on public indexers.",
          "title": "Byparr",
          "type": "stat",
          "targets": [
            {
              "expr": "label_replace(kube_pod_info{namespace=\"arr-stack\", pod=~\"byparr.*\"}, \"short_node\", \"cp$1\", \"node\", \"k8s-cp(.*)\")",
              "legendFormat": "{{ short_node }}"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "noValue": "PENDING",
              "mappings": [
                {
                  "options": {
                    "match": "null",
                    "result": {
                      "color": "yellow",
                      "text": "PENDING"
                    }
                  },
                  "type": "special"
                },
                {
                  "options": {
                    "from": 1,
                    "to": 999999999999,
                    "result": {
                      "color": "green",
                      "text": "OK"
                    }
                  },
                  "type": "range"
                },
                {
                  "options": {
                    "0": {
                      "color": "yellow",
                      "text": "NEVER RAN"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "yellow",
                    "value": null
                  },
                  {
                    "color": "green",
                    "value": 1
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 0,
            "y": 10
          },
          "id": 46,
          "options": {
            "colorMode": "background",
            "graphMode": "none",
            "justifyMode": "center",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ]
            },
            "textMode": "value_and_name"
          },
          "description": "Configarr TRaSH Guide sync CronJob (daily at 3AM). Shows OK if last run succeeded within 25 hours. PENDING = never ran or CronJob missing.",
          "title": "Configarr",
          "type": "stat",
          "targets": [
            {
              "expr": "clamp_max(kube_cronjob_status_last_successful_time{namespace=\"arr-stack\", cronjob=\"configarr\"}, 1)",
              "legendFormat": "configarr"
            }
          ]
        },
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 14
          },
          "id": 20,
          "title": "Network Traffic",
          "type": "row",
          "description": "Network throughput per service. qBittorrent shows torrent traffic (high receive = downloading). Jellyfin shows streaming traffic (high transmit = active streams). Tdarr shows NFS traffic during transcoding."
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "custom": {
                "drawStyle": "line",
                "fillOpacity": 15,
                "lineWidth": 2,
                "pointSize": 5,
                "showPoints": "never",
                "spanNulls": true,
                "stacking": {
                  "mode": "none"
                }
              },
              "unit": "Bps"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 15
          },
          "id": 21,
          "options": {
            "legend": {
              "displayMode": "list",
              "placement": "bottom"
            },
            "tooltip": {
              "mode": "multi",
              "sort": "desc"
            }
          },
          "description": "Bytes received per second by each service. qBittorrent dominates during active downloads (torrent traffic). Tdarr generates high NFS reads during transcoding. Jellyfin receives NFS reads when streaming.",
          "title": "Receive Throughput (per service)",
          "type": "timeseries",
          "targets": [
            {
              "expr": "sum by (pod) (rate(container_network_receive_bytes_total{namespace=\"arr-stack\"}[5m])) > 0",
              "legendFormat": "{{ pod }}"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "custom": {
                "drawStyle": "line",
                "fillOpacity": 15,
                "lineWidth": 2,
                "pointSize": 5,
                "showPoints": "never",
                "spanNulls": true,
                "stacking": {
                  "mode": "none"
                }
              },
              "unit": "Bps"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 15
          },
          "id": 22,
          "options": {
            "legend": {
              "displayMode": "list",
              "placement": "bottom"
            },
            "tooltip": {
              "mode": "multi",
              "sort": "desc"
            }
          },
          "description": "Bytes transmitted per second by each service. Jellyfin dominates during active streaming (sending video to clients). Tdarr writes transcoded files back to NFS. qBittorrent transmits during seeding.",
          "title": "Transmit Throughput (per service)",
          "type": "timeseries",
          "targets": [
            {
              "expr": "sum by (pod) (rate(container_network_transmit_bytes_total{namespace=\"arr-stack\"}[5m])) > 0",
              "legendFormat": "{{ pod }}"
            }
          ]
        },
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 23
          },
          "id": 30,
          "title": "Resource Usage",
          "type": "row",
          "description": "CPU and memory consumption for all ARR services. Tdarr is the heaviest companion (2 CPU limit, 2Gi memory) due to QSV transcoding. Jellyfin has 4Gi/4 CPU for streaming. Others are lightweight (128-256Mi)."
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "custom": {
                "drawStyle": "line",
                "fillOpacity": 15,
                "lineWidth": 2,
                "pointSize": 5,
                "showPoints": "never",
                "spanNulls": true,
                "stacking": {
                  "mode": "none"
                }
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 24
          },
          "id": 31,
          "options": {
            "legend": {
              "displayMode": "list",
              "placement": "bottom"
            },
            "tooltip": {
              "mode": "multi",
              "sort": "desc"
            }
          },
          "description": "CPU cores used by each ARR service. With QSV, Jellyfin/Tdarr CPU stays low even during transcoding (GPU handles video). High CPU on Sonarr/Radarr = metadata import or large library scans.",
          "title": "CPU Usage (per service)",
          "type": "timeseries",
          "targets": [
            {
              "expr": "sum by (container) (rate(container_cpu_usage_seconds_total{namespace=\"arr-stack\", container=~\"prowlarr|sonarr|radarr|qbittorrent|jellyfin|bazarr|seerr|tdarr|unpackerr|scraparr|recommendarr|byparr\"}[5m]))",
              "legendFormat": "{{ container }}"
            }
          ]
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "custom": {
                "drawStyle": "line",
                "fillOpacity": 15,
                "lineWidth": 2,
                "pointSize": 5,
                "showPoints": "never",
                "spanNulls": true,
                "stacking": {
                  "mode": "none"
                }
              },
              "unit": "bytes"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 24
          },
          "id": 32,
          "options": {
            "legend": {
              "displayMode": "list",
              "placement": "bottom"
            },
            "tooltip": {
              "mode": "multi",
              "sort": "desc"
            }
          },
          "description": "Memory working set per service. Tdarr uses most during active transcoding (up to 2Gi). Jellyfin uses 300-500Mi idle. Seerr/Recommendarr ~128-256Mi. Approaching the limit triggers OOM kill.",
          "title": "Memory Usage (per service)",
          "type": "timeseries",
          "targets": [
            {
              "expr": "sum by (container) (container_memory_working_set_bytes{namespace=\"arr-stack\", container=~\"prowlarr|sonarr|radarr|qbittorrent|jellyfin|bazarr|seerr|tdarr|unpackerr|scraparr|recommendarr|byparr\"})",
              "legendFormat": "{{ container }}"
            }
          ]
        },
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 32
          },
          "id": 10,
          "title": "Container Restarts",
          "type": "row",
          "description": "Container restart history for all ARR services. Frequent restarts may indicate OOM kills, probe failures, or configuration issues. qBittorrent uses tcpSocket probes (CSRF blocks HTTP). Tdarr may restart if GPU device plugin is unavailable."
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "custom": {
                "drawStyle": "line",
                "fillOpacity": 15,
                "lineWidth": 2,
                "pointSize": 5,
                "showPoints": "never",
                "spanNulls": true,
                "stacking": {
                  "mode": "none"
                }
              },
              "unit": "short",
              "decimals": 0,
              "min": 0
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 24,
            "x": 0,
            "y": 33
          },
          "id": 11,
          "options": {
            "legend": {
              "displayMode": "list",
              "placement": "bottom"
            },
            "tooltip": {
              "mode": "multi",
              "sort": "desc"
            }
          },
          "description": "Cumulative container restarts over time per service. A rising line indicates repeated crashes. Flat line = stable. Check pod logs for the crashing service. Common causes: OOM (check memory), failed probes, NFS mount issues, GPU device plugin unavailable (Tdarr).",
          "title": "Container Restarts (all services)",
          "type": "timeseries",
          "targets": [
            {
              "expr": "sum by (container) (increase(kube_pod_container_status_restarts_total{namespace=\"arr-stack\", container=~\"prowlarr|sonarr|radarr|qbittorrent|jellyfin|bazarr|seerr|tdarr|unpackerr|scraparr|recommendarr|byparr\"}[$__rate_interval]))",
              "legendFormat": "{{ container }}"
            }
          ]
        },
        {
          "collapsed": false,
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 41 },
          "id": 20,
          "title": "Tdarr Library Stats",
          "description": "Tdarr transcoding library health. Metrics from tdarr-exporter querying the Tdarr REST API every 60s. Transcode errors and health check errors should be investigated in the Tdarr UI.",
          "type": "row"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "unit": "GB",
              "noValue": "0",
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] }
            }
          },
          "gridPos": { "h": 4, "w": 4, "x": 0, "y": 42 },
          "id": 21,
          "options": { "colorMode": "background", "graphMode": "none", "justifyMode": "center", "reduceOptions": { "calcs": ["lastNotNull"] }, "textMode": "auto" },
          "title": "GB Saved",
          "description": "Total disk space saved by Tdarr transcoding (original size minus transcoded size). Grows as more files are processed.",
          "type": "stat",
          "targets": [{ "expr": "tdarr_size_diff_gb", "instant": true, "refId": "A" }]
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "unit": "percent",
              "noValue": "0",
              "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 50 }, { "color": "green", "value": 80 }] }
            }
          },
          "gridPos": { "h": 4, "w": 4, "x": 4, "y": 42 },
          "id": 22,
          "options": { "colorMode": "background", "graphMode": "none", "justifyMode": "center", "reduceOptions": { "calcs": ["lastNotNull"] }, "textMode": "auto" },
          "title": "Tdarr Score",
          "description": "Percentage of library files that meet Tdarr's health and codec requirements. 100% = all files healthy and in target codec.",
          "type": "stat",
          "targets": [{ "expr": "tdarr_score_pct", "instant": true, "refId": "A" }]
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "noValue": "0",
              "thresholds": { "mode": "absolute", "steps": [{ "color": "blue", "value": null }] }
            }
          },
          "gridPos": { "h": 4, "w": 4, "x": 8, "y": 42 },
          "id": 23,
          "options": { "colorMode": "background", "graphMode": "none", "justifyMode": "center", "reduceOptions": { "calcs": ["lastNotNull"] }, "textMode": "auto" },
          "title": "Files Tracked",
          "description": "Total number of files in the Tdarr library.",
          "type": "stat",
          "targets": [{ "expr": "tdarr_files_total", "instant": true, "refId": "A" }]
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "noValue": "0",
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] }
            }
          },
          "gridPos": { "h": 4, "w": 3, "x": 12, "y": 42 },
          "id": 24,
          "options": { "colorMode": "background", "graphMode": "none", "justifyMode": "center", "reduceOptions": { "calcs": ["lastNotNull"] }, "textMode": "auto" },
          "title": "Transcodes Done",
          "description": "Files successfully transcoded to target codec (typically HEVC/H.265).",
          "type": "stat",
          "targets": [{ "expr": "tdarr_library_transcodes{library_id=\"all_libraries\", status=\"success\"}", "instant": true, "refId": "A" }]
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "noValue": "0",
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1 }] }
            }
          },
          "gridPos": { "h": 4, "w": 3, "x": 15, "y": 42 },
          "id": 25,
          "options": { "colorMode": "background", "graphMode": "none", "justifyMode": "center", "reduceOptions": { "calcs": ["lastNotNull"] }, "textMode": "auto" },
          "title": "Transcode Queue",
          "description": "Files waiting to be transcoded. Will only process during enabled schedule windows. If schedule is disabled, queue won't drain.",
          "type": "stat",
          "targets": [{ "expr": "tdarr_library_transcodes{library_id=\"all_libraries\", status=\"queued\"}", "instant": true, "refId": "A" }]
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "noValue": "0",
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "red", "value": 1 }] }
            }
          },
          "gridPos": { "h": 4, "w": 3, "x": 18, "y": 42 },
          "id": 26,
          "options": { "colorMode": "background", "graphMode": "none", "justifyMode": "center", "reduceOptions": { "calcs": ["lastNotNull"] }, "textMode": "auto" },
          "title": "Transcode Errors",
          "description": "Files that failed transcoding. Open Tdarr UI → Library → Error tab to see which files and why. Common causes: corrupted source, unsupported codec, insufficient disk space.",
          "type": "stat",
          "targets": [{ "expr": "tdarr_library_transcodes{library_id=\"all_libraries\", status=\"error\"}", "instant": true, "refId": "A" }]
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "noValue": "0",
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "red", "value": 1 }] }
            }
          },
          "gridPos": { "h": 4, "w": 3, "x": 21, "y": 42 },
          "id": 27,
          "options": { "colorMode": "background", "graphMode": "none", "justifyMode": "center", "reduceOptions": { "calcs": ["lastNotNull"] }, "textMode": "auto" },
          "title": "Health Check Errors",
          "description": "Files that failed Tdarr health checks (container/stream integrity). High numbers (e.g. 73) may indicate many files have minor issues. Check Tdarr UI → Health Check tab for details.",
          "type": "stat",
          "targets": [{ "expr": "tdarr_library_health_checks{library_id=\"all_libraries\", status=\"error\"}", "instant": true, "refId": "A" }]
        },
        {
          "collapsed": false,
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 46 },
          "id": 30,
          "title": "qBittorrent Download Activity",
          "description": "Torrent client status from qbittorrent-exporter. Shows active downloads, seeding, and transfer speeds. Requires qbittorrent-exporter-secret.",
          "type": "row"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "noValue": "0",
              "thresholds": { "mode": "absolute", "steps": [{ "color": "blue", "value": null }, { "color": "green", "value": 1 }] }
            }
          },
          "gridPos": { "h": 4, "w": 4, "x": 0, "y": 47 },
          "id": 31,
          "options": { "colorMode": "background", "graphMode": "none", "justifyMode": "center", "reduceOptions": { "calcs": ["lastNotNull"] }, "textMode": "auto" },
          "title": "Downloading",
          "description": "Torrents actively downloading from peers right now.",
          "type": "stat",
          "targets": [{ "expr": "sum(qbittorrent_torrents_count{status=\"downloading\"})", "instant": true, "refId": "A" }]
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "noValue": "0",
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] }
            }
          },
          "gridPos": { "h": 4, "w": 4, "x": 4, "y": 47 },
          "id": 32,
          "options": { "colorMode": "background", "graphMode": "none", "justifyMode": "center", "reduceOptions": { "calcs": ["lastNotNull"] }, "textMode": "auto" },
          "title": "Seeding",
          "description": "Torrents seeding (uploading to other peers). Includes both actively uploading and stalled seeding.",
          "type": "stat",
          "targets": [{ "expr": "sum(qbittorrent_torrents_count{status=~\"uploading|stalledUP\"})", "instant": true, "refId": "A" }]
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "noValue": "0",
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1 }] }
            }
          },
          "gridPos": { "h": 4, "w": 4, "x": 8, "y": 47 },
          "id": 33,
          "options": { "colorMode": "background", "graphMode": "none", "justifyMode": "center", "reduceOptions": { "calcs": ["lastNotNull"] }, "textMode": "auto" },
          "title": "Stalled",
          "description": "Downloads stalled — no seeds available or peer connections failing. Investigate if non-zero for extended periods.",
          "type": "stat",
          "targets": [{ "expr": "sum(qbittorrent_torrents_count{status=\"stalledDL\"})", "instant": true, "refId": "A" }]
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "noValue": "0",
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1 }] }
            }
          },
          "gridPos": { "h": 4, "w": 4, "x": 12, "y": 47 },
          "id": 34,
          "options": { "colorMode": "background", "graphMode": "none", "justifyMode": "center", "reduceOptions": { "calcs": ["lastNotNull"] }, "textMode": "auto" },
          "title": "Paused",
          "description": "Paused torrents (manually paused or reached seeding ratio limit).",
          "type": "stat",
          "targets": [{ "expr": "sum(qbittorrent_torrents_count{status=~\"pausedDL|pausedUP\"})", "instant": true, "refId": "A" }]
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": { "defaults": { "unit": "Bps", "noValue": "0 B/s", "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] } } },
          "gridPos": { "h": 4, "w": 4, "x": 16, "y": 47 },
          "id": 35,
          "options": { "colorMode": "background", "graphMode": "none", "justifyMode": "center", "reduceOptions": { "calcs": ["lastNotNull"] }, "textMode": "auto" },
          "title": "DL Speed",
          "description": "Current aggregate download speed across all active torrents. Derived from rate of qbittorrent_dl_info_data_total counter.",
          "type": "stat",
          "targets": [{ "expr": "rate(qbittorrent_dl_info_data_total[5m])", "instant": true, "refId": "A" }]
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": { "defaults": { "unit": "Bps", "noValue": "0 B/s", "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] } } },
          "gridPos": { "h": 4, "w": 4, "x": 20, "y": 47 },
          "id": 36,
          "options": { "colorMode": "background", "graphMode": "none", "justifyMode": "center", "reduceOptions": { "calcs": ["lastNotNull"] }, "textMode": "auto" },
          "title": "UL Speed",
          "description": "Current aggregate upload speed across all seeding torrents. Derived from rate of qbittorrent_up_info_data_total counter.",
          "type": "stat",
          "targets": [{ "expr": "rate(qbittorrent_up_info_data_total[5m])", "instant": true, "refId": "A" }]
        },
        {
          "collapsed": false,
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 51 },
          "id": 40,
          "title": "Recent Activity",
          "description": "Live log stream from ARR stack pods via Loki. Warnings and errors surface silent failures. App activity shows RSS syncs, grabs, imports, and search queries.",
          "type": "row"
        },
        {
          "datasource": { "type": "loki", "uid": "loki" },
          "gridPos": { "h": 10, "w": 24, "x": 0, "y": 52 },
          "id": 41,
          "options": {
            "dedupStrategy": "none",
            "enableLogDetails": true,
            "prettifyLogMessage": false,
            "showLabels": true,
            "showTime": true,
            "sortOrder": "Descending",
            "wrapLogMessage": false
          },
          "title": "Warnings & Errors",
          "description": "All warning and error log lines across the entire ARR stack. This is the single most useful panel — surfaces silent failures from any app without needing to check each pod individually.",
          "type": "logs",
          "targets": [
            {
              "datasource": { "type": "loki", "uid": "loki" },
              "expr": "{namespace=\"arr-stack\"} |~ \"\\\\[(Warn|Error)\\\\]\"",
              "queryType": "range",
              "refId": "A"
            }
          ]
        },
        {
          "datasource": { "type": "loki", "uid": "loki" },
          "gridPos": { "h": 10, "w": 24, "x": 0, "y": 62 },
          "id": 42,
          "options": {
            "dedupStrategy": "none",
            "enableLogDetails": true,
            "prettifyLogMessage": false,
            "showLabels": true,
            "showTime": true,
            "sortOrder": "Descending",
            "wrapLogMessage": false
          },
          "title": "ARR App Activity",
          "description": "Info-level activity from Radarr, Sonarr, and Prowlarr — RSS sync results, grab events, search queries, imports. Authentication noise and repetitive sync-start/complete lines are filtered out.",
          "type": "logs",
          "targets": [
            {
              "datasource": { "type": "loki", "uid": "loki" },
              "expr": "{namespace=\"arr-stack\", app=~\"radarr|sonarr|prowlarr\"} |~ \"\\\\[Info\\\\]\" != \"AuthenticationScheme\" != \"Starting RSS Sync\" != \"Starting Import List\" != \"No list items\"",
              "queryType": "range",
              "refId": "A"
            }
          ]
        }
      ],
      "schemaVersion": 39,
      "tags": [
        "arr-stack",
        "media"
      ],
      "templating": {
        "list": []
      },
      "refresh": "10s",
      "time": {
        "from": "now-12h",
        "to": "now"
      },
      "timepicker": {},
      "timezone": "Asia/Manila",
      "title": "ARR Media Stack",
      "uid": "arr-stack-overview",
      "version": 2
    }
